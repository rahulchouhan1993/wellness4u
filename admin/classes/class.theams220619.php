<?phpinclude_once("class.paging.php");include_once("class.admin.php");class Theams extends Admin{            public function GetAllPersonalitiesVivek()	{		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();			$admin_id = $_SESSION['admin_id'];		$edit_action_id = '302';		$delete_action_id = '304';		$obj = new Theams();		$edit = $this->chkValidActionPermission($admin_id,$edit_action_id);				$delete = $this->chkValidActionPermission($admin_id,$delete_action_id);			$sql = "SELECT * FROM `tbl_icons` ORDER BY status DESC, icons_add_date DESC";							//$this->execute_query($sql);		$STH = $DBH->prepare($sql);                $STH->execute();		$total_records=$STH->rowCount();		$record_per_page=100;		$scroll=5;		$page=new Page();     	        $page->set_page_data($_SERVER['PHP_SELF'],$total_records,$record_per_page,$scroll,true,true,true);		$page->set_link_parameter("Class = paging");		$page->set_qry_string($str="mode=icons");	 	//$result=$this->execute_query($page->get_limit_query($sql));		$STH2 = $DBH->prepare($page->get_limit_query($sql));                $STH2->execute();		$output = '';				if($STH2->rowCount() > 0)		{			if( isset($_GET['page']) && is_numeric($_GET['page']) && $_GET['page'] > 0 )			{				$i = $page->start + 1;			}			else			{				$i = 1;			}						while($row = $STH2->fetch(PDO::FETCH_ASSOC))			{			    if($row['status'] == 1)					{						 $status = 'Active'; 					}					else					{ 						$status = 'Inactive';					}                                                                        $start_date = ($row['start_date']!='0000-00-00'? $row['start_date'] : '');                                $end_date = ($row['end_date']!='0000-00-00'? $row['end_date'] : '');                                $single_date = ($row['single_date']!='0000-00-00'? $row['single_date'] : '');				$output .= '<tr class="manage-row">';				$output .= '<td height="30"  align="center" nowrap="nowrap" >'.$i.'</td>';                                $output .= '<td height="30" align="center">'.$status.'</td>';				$output .= '<td height="30" align="center">'.$obj->getAdminNameRam($row['identity_id']).'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['icons_add_date']).'</td>';				$output .= '<td height="30" align="center" nowrap="nowrap">';						                                if($edit) {                                    				$output .= '<a href="index.php?mode=edit_icons&id='.$row['icons_id'].'" ><img src = "images/edit.gif" border="0"></a>';								}				$output .= '</td>';				$output .= '<td height="30" align="center" nowrap="nowrap">';						if($delete) {				$output .= '<a href=\'javascript:fn_confirmdelete("icons","sql/delicons.php?id='.$row['icons_id'].'")\' ><img src = "images/del.gif" border="0" ></a>';							}                                $output .= '<td height="30" align="center">'.stripslashes($row['icons_front_id']).'</td>';                                $output .= '<td height="30" align="center">'.stripslashes($obj->getFavCategoryNameVivek($row['icons_type_id'])).'</td>';                                $output .= '<td height="30" align="center">'.stripslashes($row['admin_comment']).'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['icons_name']).'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['color_code']).'</td>';//				$output .= '<td height="30" align="center">'.stripslashes($row['image']).'</td>';                                $output .= '<td><img src="../uploads/'.stripslashes($row['image']).'" height="50px;" width="50px;" align="center"></td>';                                $output .= '<td height="30" align="center">'.stripslashes($row['comment']).'</td>';				$output .= '<td height="30" align="center">'.$obj->getFavCategoryNameVivek($row['display_type']).'</td>';				$output .= '<td height="30" align="center">'.$row['order_no'].'</td>';				$output .= '<td height="30" align="center">'.$row['display_name'].'</td>';				$output .= '<td height="30" align="center">'.$row['link'].'</td>';                                $output .= '<td height="30" align="center">'.$row['ref_table'].'</td>';				$output .= '<td height="30" align="center">'.$row['wellbgn_ref_num'].'</td>';				$output .= '<td height="30" align="center">'.$obj->getSubFavCategoryTypeNameVivek($row['fav_cat_id']).'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['listing_date_type']).'</td>';                                $output .= '<td height="30" align="center">'.stripslashes($row['days_of_month']).'</td>';                                $output .= '<td height="30" align="center">'.$single_date.'</td>';                                $output .= '<td height="30" align="center">'.$start_date.'</td>';                                $output .= '<td height="30" align="center">'.$end_date.'</td>';                                $output .= '<td height="30" align="center">'.$obj->getDayOfWeekOptionsMultiple($row['days_of_week']).'</td>';                                $output .= '<td height="30" align="center">'.$obj->getMonthsOptionsMultiple($row['months']).'</td>';								$output .= '</td>';				$output .= '</tr>';				$i++;			}		}		else		{			$output = '<tr class="manage-row" height="20"><td colspan="8" align="center">NO PAGES FOUND</td></tr>';		}				$page->get_page_nav();		return $output;	}            public function getFavCategoryNameVivek($fav_cat_id)	{           // $this->connectDB();            $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();            $DBH->beginTransaction();            $fav_cat_type = '';            //$sql = "SELECT * FROM `tblfavcategorytype` WHERE `fav_cat_type_id` = '".$fav_cat_type_id."' ";            $sql = "SELECT * FROM `tblfavcategory` WHERE `fav_cat_id` = '".$fav_cat_id."' ";           // $this->execute_query($sql);            $STH = $DBH->prepare($sql);            $STH->execute();            if($STH->rowCount() > 0)            {                $row = $STH->fetch(PDO::FETCH_ASSOC);                $fav_cat_type = stripslashes($row['fav_cat']);            }            return $fav_cat_type;	}	public function GetAllPersonalities()	{		//$this->connectDB();	        $my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();		$admin_id = $_SESSION['admin_id'];		$edit_action_id = '302';		$delete_action_id = '304';				$edit = $this->chkValidActionPermission($admin_id,$edit_action_id);				$delete = $this->chkValidActionPermission($admin_id,$delete_action_id);			$sql = "SELECT * FROM `tbl_icons` ORDER BY status DESC, icons_add_date DESC";							//$this->execute_query($sql);		        $STH = $DBH->prepare($sql);                $STH->execute();		$total_records=$STH->rowCount();		$record_per_page=100;		$scroll=5;		$page=new Page();                 $page->set_page_data($_SERVER['PHP_SELF'],$total_records,$record_per_page,$scroll,true,true,true);		$page->set_link_parameter("Class = paging");		$page->set_qry_string($str="mode=theams");	 	//$result=$this->execute_query($page->get_limit_query($sql));		$STH2 = $DBH->prepare($page->get_limit_query($sql));                $STH2->execute();		$output = '';				if($STH2->rowCount() > 0)		{			if( isset($_GET['page']) && is_numeric($_GET['page']) && $_GET['page'] > 0 )			{				$i = $page->start + 1;			}			else			{				$i = 1;			}						while($row = $STH2->fetch(PDO::FETCH_ASSOC))			{			    if($row['status'] == 1)					{						 $status = 'Active'; 					}					else					{ 						$status = 'Inactive';					}                                                                                $start_date = ($row['start_date']!='0000-00-00'? $row['start_date'] : '');                                        $end_date = ($row['end_date']!='0000-00-00'? $row['end_date'] : '');                                        $single_date = ($row['single_date']!='0000-00-00'? $row['single_date'] : '');                                        				$output .= '<tr class="manage-row">';				$output .= '<td height="30"  align="center" nowrap="nowrap" >'.$i.'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['icons_name']).'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['color_code']).'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['image']).'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['listing_date_type']).'</td>';                                $output .= '<td height="30" align="center">'.stripslashes($row['days_of_month']).'</td>';                                $output .= '<td height="30" align="center">'.$single_date.'</td>';                                $output .= '<td height="30" align="center">'.$start_date.'</td>';                                $output .= '<td height="30" align="center">'.$end_date.'</td>';                                $output .= '<td height="30" align="center">'.stripslashes($row['days_of_week']).'</td>';                                $output .= '<td height="30" align="center">'.stripslashes($row['months']).'</td>';				$output .= '<td height="30" align="center">'.$status.'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['icons_add_date']).'</td>';				$output .= '<td height="30" align="center" nowrap="nowrap">';						if($edit) {				$output .= '<a href="index.php?mode=edit_icons&uid='.$row['icons_id'].'" ><img src = "images/edit.gif" border="0"></a>';								}				$output .= '</td>';				$output .= '<td height="30" align="center" nowrap="nowrap">';						if($delete) {				$output .= '<a href=\'javascript:fn_confirmdelete("Theam","sql/deltheam.php?id='.$row['icons_id'].'")\' ><img src = "images/del.gif" border="0" ></a>';							}				$output .= '</td>';				$output .= '</tr>';				$i++;			}		}		else		{			$output = '<tr class="manage-row" height="20"><td colspan="8" align="center">NO PAGES FOUND</td></tr>';		}				$page->get_page_nav();		return $output;	}	        public function GetAllPages()	{		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();	        $obj = new Theams(); 		                $admin_id = $_SESSION['admin_id'];		$edit_action_id = '100';		$delete_action_id = '102';				$edit = $this->chkValidActionPermission($admin_id,$edit_action_id);				$delete = $this->chkValidActionPermission($admin_id,$delete_action_id);			$sql = "SELECT * FROM `tbltheams` ORDER BY status DESC, theam_add_date DESC";							//$this->execute_query($sql);		$STH = $DBH->prepare($sql);                $STH->execute();		$total_records=$STH->rowCount();		$record_per_page=100;		$scroll=5;		$page=new Page();                 $page->set_page_data($_SERVER['PHP_SELF'],$total_records,$record_per_page,$scroll,true,true,true);		$page->set_link_parameter("Class = paging");		$page->set_qry_string($str="mode=theams");	 	//$result=$this->execute_query($page->get_limit_query($sql));		$STH2 = $DBH->prepare($page->get_limit_query($sql));                $STH2->execute();		$output = '';				if($STH2->rowCount() > 0)		{			if( isset($_GET['page']) && is_numeric($_GET['page']) && $_GET['page'] > 0 )			{				$i = $page->start + 1;			}			else			{				$i = 1;			}						while($row = $STH2->fetch(PDO::FETCH_ASSOC))			{			    if($row['status'] == 1)					{						 $status = 'Active'; 					}					else					{ 						$status = 'Inactive';					}                                                                                 $start_date = ($row['start_date']!='0000-00-00'? $row['start_date'] : '');                                        $end_date = ($row['end_date']!='0000-00-00'? $row['end_date'] : '');                                        $single_date = ($row['single_date']!='0000-00-00'? $row['single_date'] : '');                                        				$output .= '<tr class="manage-row">';				$output .= '<td height="30"  align="center" nowrap="nowrap" >'.$i.'</td>';                                $output .= '<td height="30" align="center">'.$obj->getAdminNameRam($row['identity_id']).'</td>';				$output .= '<td height="30" align="center">'.$status.'</td>';				$output .= '<td height="30" align="center" nowrap="nowrap">';						if($edit) {				$output .= '<a href="index.php?mode=edit_theam&uid='.$row['theam_id'].'" ><img src = "images/edit.gif" border="0"></a>';								}				$output .= '</td>';				$output .= '<td height="30" align="center" nowrap="nowrap">';						if($delete) {				$output .= '<a href=\'javascript:fn_confirmdelete("Theam","sql/deltheam.php?uid='.$row['theam_id'].'")\' ><img src = "images/del.gif" border="0" ></a>';							}				$output .= '</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['theam_name']).'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['color_code']).'</td>';				$output .= '<td height="30" align="center"><img src="../uploads/'.stripslashes($row['image']).'" style="width:50px; height:50px;"/></td>';				$output .= '<td height="30" align="center">'.stripslashes($row['listing_date_type']).'</td>';                                $output .= '<td height="30" align="center">'.stripslashes($row['days_of_month']).'</td>';                                 $output .= '<td height="30" align="center">'.$single_date.'</td>';                                $output .= '<td height="30" align="center">'.$start_date.'</td>';                                $output .= '<td height="30" align="center">'.$end_date.'</td>';                                $output .= '<td height="30" align="center">'.$obj->getDayOfWeekOptionsMultiple($row['days_of_week']).'</td>';                                 $output .= '<td height="30" align="center">'.$obj->getMonthsOptionsMultiple($row['months']).'</td>';								$output .= '</tr>';				$i++;			}		}		else		{			$output = '<tr class="manage-row" height="20"><td colspan="8" align="center">NO PAGES FOUND</td></tr>';		}				$page->get_page_nav();		return $output;	}	                	public function Add_Theams($identity_id,$theam_name,$listing_date_type,$days_of_month,$single_date,$start_date,$end_date,$days_of_week,$months,$color_code,$image,$credit,$credit_url,$day)	{		//$this->connectDB();            $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();            $DBH->beginTransaction();	    $return=false;		$ins_sql = "INSERT INTO `tbltheams`(`identity_id`,`theam_name`,`listing_date_type`,`days_of_month`,`single_date`,`start_date`,`end_date`,`days_of_week`,`months`,`color_code`,`image`,`credit`,`credit_url`,`day`,`status`) VALUES ('".addslashes($identity_id)."','".addslashes($theam_name)."','".addslashes($listing_date_type)."','".addslashes($days_of_month)."','".addslashes($single_date)."','".addslashes($start_date)."','".addslashes($end_date)."','".addslashes($days_of_week)."','".addslashes($months)."','".addslashes($color_code)."','".addslashes($image)."','".addslashes($credit)."','".addslashes($credit_url)."','".addslashes($day)."' ,'1')";		//echo $sql;		//$this->execute_query($ins_sql);		$STH = $DBH->prepare($ins_sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;		//return $this->result;	}                public function Add_Personalities($admin_comment,$ref_table,$wellbgn_ref_num,$order,$identity_type,$identity_id,$link,$fav_cat_type_id,$fav_cat_id,$display_type,$card_name,$icons_type_id,$icons_front_id,$icons_name,$listing_date_type,$days_of_month,$single_date,$start_date,$end_date,$days_of_week,$months,$color_code,$image,$comment,$credit,$credit_url,$day,$take_key_card_name,$take_key_fav_cat_type_id,$take_key_fav_cat_id,$take_key_wellbgn_ref_num,$take_key_comment,$group_code,$take_key_group_code)	{           		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();		$return=false;	        $ins_sql = "INSERT INTO `tbl_icons`(`wellbgn_ref_num`,`order_no`,`identity_type`,`identity_id`,`link`,`icons_front_id`,`comment`,`fav_cat_type_id`,`fav_cat_id`,`display_type`,`display_name`,`icons_type_id`,`icons_name`,`listing_date_type`,`days_of_month`,`single_date`,`start_date`,`end_date`,`days_of_week`,`months`,`color_code`,`image`,`credit`,`credit_url`,`day`,`status`,`admin_comment`,`ref_table`,`take_key_wellbgn_ref_num`,`take_key_card_name`,`take_key_fav_cat_type_id`,`take_key_fav_cat_id`,`take_key_comment`,`group_code_id`,`take_key_group_code`) VALUES ('".addslashes($wellbgn_ref_num)."','".addslashes($order)."','".addslashes($identity_type)."','".addslashes($identity_id)."','".addslashes($link)."','".addslashes($icons_front_id)."','".addslashes($comment)."','".addslashes($fav_cat_type_id)."','".addslashes($fav_cat_id)."','".addslashes($display_type)."','".addslashes($card_name)."','".addslashes($icons_type_id)."','".addslashes($icons_name)."','".addslashes($listing_date_type)."','".addslashes($days_of_month)."','".addslashes($single_date)."','".addslashes($start_date)."','".addslashes($end_date)."','".addslashes($days_of_week)."','".addslashes($months)."','".addslashes($color_code)."','".addslashes($image)."','".addslashes($credit)."','".addslashes($credit_url)."','".addslashes($day)."' ,'1','".addslashes($admin_comment)."','".addslashes($ref_table)."','".addslashes($take_key_wellbgn_ref_num)."','".addslashes($take_key_card_name)."','".addslashes($take_key_fav_cat_type_id)."','".addslashes($take_key_fav_cat_id)."','".addslashes($take_key_comment)."','".$group_code."','".$take_key_group_code."')";		//echo $sql;		//$this->execute_query($ins_sql);		$STH = $DBH->prepare($ins_sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;		//return $this->result;	}		public function getTheamDetails($theam_id)	{		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();		$theam_name = '';		$color_code = '';		$image = '';		$credit = '';		$credit_url = '';                $day = '';		$status = '';						$sql = "SELECT * FROM `tbltheams` WHERE `theam_id` = '".$theam_id."'";						//$this->execute_query($sql);		$STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$row = $STH->fetch(PDO::FETCH_ASSOC);			$theam_name = stripslashes($row['theam_name']);			$color_code = stripslashes($row['color_code']);			$image = stripslashes($row['image']);			$credit = stripslashes($row['credit']);			$credit_url = stripslashes($row['credit_url']);			$status = stripslashes($row['status']);			$listing_date_type = stripslashes($row['listing_date_type']);                        $days_of_month = stripslashes($row['days_of_month']);                        $single_date = stripslashes($row['single_date']);                        $start_date = stripslashes($row['start_date']);                        $end_date = stripslashes($row['end_date']);                        $days_of_week = stripslashes($row['days_of_week']);                        $months = stripslashes($row['months']);		}		return array($theam_name,$color_code,$image,$credit,$credit_url,$status,$listing_date_type,$days_of_month,$single_date,$start_date,$end_date,$days_of_week,$months);	}		public function Update_Theam($identity_id,$status,$theam_id,$theam_name,$listing_date_type,$days_of_month,$single_date,$start_date,$end_date,$days_of_week,$months,$color_code,$image,$credit,$credit_url,$day)	{ 		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();	    $return=false;	 $sql = "UPDATE `tbltheams` SET `identity_id` = '".addslashes($identity_id)."' ,`status` = '".addslashes($status)."' ,`theam_name` = '".addslashes($theam_name)."' ,`listing_date_type` = '".addslashes($listing_date_type)."' ,`days_of_month` = '".addslashes($days_of_month)."' ,`single_date` = '".addslashes($single_date)."' ,`start_date` = '".addslashes($start_date)."' ,`end_date` = '".addslashes($end_date)."' ,`days_of_week` = '".addslashes($days_of_week)."' ,`months` = '".addslashes($months)."' , `color_code` = '".addslashes($color_code)."' , `image` = '".addslashes($image)."' , `credit` = '".addslashes($credit)."', `credit_url` = '".addslashes($credit_url)."', `status` = '".addslashes($status)."',`day` = '".addslashes($day)."'  WHERE `theam_id` = '".$theam_id."'";	 	  //$this->execute_query($sql);	   $STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;		//return $this->result;	}			public function Deletetheam($uid)	{		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();	   $return=false;		$sql = "DELETE  FROM `tbltheams` WHERE `theam_id` = '".$uid."'";		$STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;	}                public function chkiconsItemAlreadyExists_edit($icons_name,$icons_id)	{		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();		$return = false;				$sql = "SELECT * FROM `tbl_icons` WHERE `icons_name` = '".addslashes($icons_name)."' AND `icons_id` != '".$icons_id."'";		$STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;	}        public function chkcolorcodeAlreadyExists($color_code)	{		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();		$return = false;				$sql = "SELECT * FROM `tbl_icons` WHERE `color_code` = '".addslashes($color_code)."'";		//$this->execute_query($sql);		$STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;	}                public function getIconsDetails($icons_id)	{		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();		$icons_name = '';                $listing_date_type='';                $days_of_month='';                $single_date='';                $start_date='';                $end_date='';                $days_of_week='';                 $months='';		$color_code = '';		$image = '';		$credit = '';		$credit_url = '';	        $day = '';		$status = '';		$order = '';	                                $group_code = '';                                $take_key_group_code = '';		 $sql = "SELECT * FROM `tbl_icons` WHERE `icons_id` = '".$icons_id."'";								//$this->execute_query($sql);		$STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$row = $STH->fetch(PDO::FETCH_ASSOC);			$icons_type_id = stripslashes($row['icons_type_id']);			$icons_front_id = stripslashes($row['icons_front_id']);                        $comment = stripslashes($row['comment']);			$display_type = stripslashes($row['display_type']);                        $card_name = stripslashes($row['display_name']);			$fav_cat_type_id = stripslashes($row['fav_cat_type_id']);                        $fav_cat_id = stripslashes($row['fav_cat_id']);                        			$icons_name = stripslashes($row['icons_name']);			$color_code = stripslashes($row['color_code']);			$image = stripslashes($row['image']);			$credit = stripslashes($row['credit']);			$credit_url = stripslashes($row['credit_url']);			$status = stripslashes($row['status']);			$listing_date_type = stripslashes($row['listing_date_type']);                        $days_of_month = stripslashes($row['days_of_month']);                        $single_date = stripslashes($row['single_date']);                        $start_date = stripslashes($row['start_date']);                        $end_date = stripslashes($row['end_date']);                        $days_of_week = stripslashes($row['days_of_week']);                        $months = stripslashes($row['months']);                                                $single_date = stripslashes($row['single_date']);                        $start_date = stripslashes($row['start_date']);                        $end_date = stripslashes($row['end_date']);                        $days_of_week = stripslashes($row['days_of_week']);                        $months = stripslashes($row['months']);			            $link = stripslashes($row['link']);                        $identity_id = stripslashes($row['identity_id']);                        $order = stripslashes($row['order_no']);                        $wellbgn_ref_num = stripslashes($row['wellbgn_ref_num']);                       $take_key_wellbgn_ref_num=stripslashes($row['take_key_wellbgn_ref_num']);                       $take_key_fav_cat_id = stripslashes($row['take_key_fav_cat_id']);                       $take_key_fav_cat_type_id = stripslashes($row['take_key_fav_cat_type_id']);                       $take_key_card_name = stripslashes($row['take_key_card_name']);                       $take_key_comment = stripslashes($row['take_key_comment']);                       $admin_comment = ($row['admin_comment']);                       $ref_table = stripslashes($row['ref_table']);                       $group_code = ($row['group_code_id']);                                              $take_key_group_code = $row['take_key_group_code'];					}		return array($admin_comment,$ref_table,$wellbgn_ref_num,$order,$identity_id,$link,$icons_type_id,$icons_front_id,$comment,$display_type,$card_name,$fav_cat_type_id,$fav_cat_id,$icons_name,$color_code,$image,$credit,$credit_url,$status,$listing_date_type,$days_of_month,$single_date,$start_date,$end_date,$days_of_week,$months,$take_key_wellbgn_ref_num,$take_key_card_name,$take_key_fav_cat_type_id,$take_key_fav_cat_id,$take_key_comment,$group_code,$take_key_group_code);	}		public function Update_icons($admin_comment,$ref_table,$wellbgn_ref_num,$order,$identity_id,$link,$icons_type_id,$icons_front_id,$fav_cat_type_id,$fav_cat_id,$display_type,$card_name,$comment,$icons_id,$icons_name,$listing_date_type,$days_of_month,$single_date,$start_date,$end_date,$days_of_week,$months,$color_code,$image,$credit,$credit_url,$day,$status,$take_key_wellbgn_ref_num,$take_key_card_name,$take_key_fav_cat_type_id,$take_key_fav_cat_id,$take_key_comment,$group_code,$take_key_group_code)	{            		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                 $DBH->beginTransaction();		 $return=false;                 $sql = "UPDATE `tbl_icons` SET `take_key_group_code` = '".$take_key_group_code."', `group_code_id` = '".$group_code."', `admin_comment` = '".addslashes($admin_comment)."' ,`ref_table` = '".addslashes($ref_table)."' , `wellbgn_ref_num` = '".addslashes($wellbgn_ref_num)."',`order_no` = '".addslashes($order)."',`identity_id` = '".addslashes($identity_id)."',`link` = '".addslashes($link)."',`icons_type_id` = '".addslashes($icons_type_id)."',`icons_front_id` = '".addslashes($icons_front_id)."',`fav_cat_type_id` = '".addslashes($fav_cat_type_id)."',`fav_cat_id` = '".addslashes($fav_cat_id)."',`display_type` = '".addslashes($display_type)."',`display_name` = '".addslashes($card_name)."',`comment` = '".addslashes($comment)."',`icons_name` = '".addslashes($icons_name)."', `listing_date_type` = '".addslashes($listing_date_type)."' , `days_of_month` = '".addslashes($days_of_month)."' , `single_date` = '".addslashes($single_date)."' ,`start_date` = '".addslashes($start_date)."',`end_date` = '".addslashes($end_date)."' , `days_of_week` = '".addslashes($days_of_week)."' , `months` = '".addslashes($months)."' , `color_code` = '".addslashes($color_code)."' , `image` = '".addslashes($image)."' , `credit` = '".addslashes($credit)."', `credit_url` = '".addslashes($credit_url)."', `status` = '".addslashes($status)."',`day` = '".addslashes($day)."',`take_key_wellbgn_ref_num`='".addslashes($take_key_wellbgn_ref_num)."',`take_key_card_name`='".addslashes($take_key_card_name)."',`take_key_fav_cat_type_id`='".addslashes($take_key_fav_cat_type_id)."',`take_key_fav_cat_id`='".addslashes($take_key_fav_cat_id)."',`take_key_comment`='".addslashes($take_key_comment)."'  WHERE `icons_id` = '".$icons_id."'";		                   $STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;	       // $this->execute_query($sql);		//return $this->result;                                			}			public function Deleteicons($uid)	{		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();		$return=false;		$sql = "DELETE  FROM `tbl_icons` WHERE `theam_id` = '".$uid."'";		$STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;	}//        vivek start                public function getFavCategoryTypeNameVivek($fav_cat_type_id)	{            $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();            $DBH->beginTransaction();            $fav_cat_type = '';            //$sql = "SELECT * FROM `tblfavcategorytype` WHERE `fav_cat_type_id` = '".$fav_cat_type_id."' ";            $sql = "SELECT * FROM `tblprofilecustomcategories` WHERE `prct_cat_id` = '".$fav_cat_type_id."' ";            //$this->execute_query($sql);            $STH = $DBH->prepare($sql);            $STH->execute();            if($STH->rowCount() > 0)            {                $row = $STH->fetch(PDO::FETCH_ASSOC);                $fav_cat_type = stripslashes($row['prct_cat']);            }            return $fav_cat_type;	}                 public function getSubFavCategoryTypeNameVivek($fav_cat_type_id)	{            //$this->connectDB();            $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();            $DBH->beginTransaction();            $fav_cat_type = '';            //$sql = "SELECT * FROM `tblfavcategorytype` WHERE `fav_cat_type_id` = '".$fav_cat_type_id."' ";            $sql = "SELECT * FROM `tblfavcategory` WHERE `fav_cat_id` = '".$fav_cat_type_id."' ";            $STH = $DBH->prepare($sql);            $STH->execute();            if($STH->rowCount() > 0)            {                $row = $STH->fetch(PDO::FETCH_ASSOC);                $fav_cat_type = stripslashes($row['fav_cat']);            }            return $fav_cat_type;	}                public function DeleteIconsVivek($uid)	{		$my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();           $DBH->beginTransaction();	  $return=false;		$sql = "DELETE  FROM `tbl_icons` WHERE `icons_id` = '".$uid."'";		//$this->execute_query($sql);		$STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;		//return $this->result;	}                 public function getAdminNameRam($id)	{            $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();           $DBH->beginTransaction();            $return = '';                        $sql = "SELECT * FROM `tbladmin` WHERE `admin_id` = '".$id."' ";           // $this->execute_query($sql);		   $STH = $DBH->prepare($sql);           $STH->execute();            if($STH->rowCount() > 0)            {                    $row = $STH->fetch(PDO::FETCH_ASSOC);                    $return = $row['fname'].' '.$row['lname'];            }            return $return;	}            public function getDayOfWeekOptionsMultiple($day_of_week){    //    print_r($day_of_week);     $option_str = '';        $arr_day_of_week = array (        1 => 'Sunday',        2 => 'Monday',        3 => 'Tuesday',        4 => 'Wednesday',        5 => 'Thursday',        6 => 'Friday',        7 => 'Saturday'    );//print_r($arr_day_of_week);die();$selected_data=array();$day_of_week=explode(',',$day_of_week);//print_r($day_of_week);    foreach($arr_day_of_week as $k => $v )    {            if(in_array($k ,$day_of_week))            {//               array_push($selected_data,$v);                $selected_data[] =  $v;            }           //            $option_str .= '<option value="'.$k.'" '.$selected.' >'.$v.'</option>';    }	//print_r($selected_data);    $selected_data_implode=implode(',',$selected_data);    return $selected_data_implode;}public function getMonthsOptionsMultiple($arr_month){        $option_str = '';        $arr_record = array (        1 => 'January',        2 => 'February',        3 => 'March',        4 => 'April',        5 => 'May',        6 => 'June',        7 => 'July',        8 => 'August',        9 => 'September',        10 => 'October',        11 => 'November',        12 => 'December'    );$arr_month=explode(',',$arr_month);    foreach($arr_record as $k => $v )    {            if(in_array($k ,$arr_month))            {                $selected[] = $v;            }               }	$selected_implode=implode(',',$selected);    return $selected_implode;} public function chkOrderNumberFromTblIconsVivek($order,$display_type)	{           // $this->connectDB();           $my_DBH = new mysqlConnection();           $DBH = $my_DBH->raw_handle();           $DBH->beginTransaction();            $fav_cat_type = '';            $sql = "SELECT * FROM `tbl_icons` WHERE `order_no` = '".$order."' and `status` = '1' and `display_type` = '".$display_type."'";            //$this->execute_query($sql);            $STH = $DBH->prepare($sql);            $STH->execute();            if($STH->rowCount() > 0)            {               $row = $STH->fetch(PDO::FETCH_ASSOC);                $fav_cat_type = stripslashes($row['icons_id']);            }            return $fav_cat_type;	}public function chkEditOrderNumberFromTblIconsVivek($icons_id,$order,$display_type)	{           $my_DBH = new mysqlConnection();           $DBH = $my_DBH->raw_handle();           $DBH->beginTransaction();            $fav_cat_type = '';            $sql = "SELECT * FROM `tbl_icons` WHERE `order_no` = '".$order."' and `status` = '1' and `display_type` = '".$display_type."' and `icons_id` != '".$icons_id."'";            $STH = $DBH->prepare($sql);            $STH->execute();           if($STH->rowCount() > 0)            {                $row = $STH->fetch(PDO::FETCH_ASSOC);                $fav_cat_type = stripslashes($row['icons_id']);            }            return $fav_cat_type;	}                        public function getReferenceNumberOption($wellbgn_ref_num)	{           $my_DBH = new mysqlConnection();           $DBH = $my_DBH->raw_handle();           $DBH->beginTransaction();            $option_str = array();		            $sql = "SELECT * FROM `tblsolutionitems` ";            $STH = $DBH->prepare($sql);            $STH->execute();                      if($STH->rowCount() > 0)            {                while( $row = $STH->fetch(PDO::FETCH_ASSOC))                {                                      $option_str[]=$row['wellbgn_ref_num'];                }            }            //echo $option_str;                        return $option_str;	}      //        class exclusion start         public function GetAllExclusionPagesData($search,$status,$updated_by)	{		   $my_DBH = new mysqlConnection();           $DBH = $my_DBH->raw_handle();           $DBH->beginTransaction();	        $obj = new Theams(); 		                $admin_id = $_SESSION['admin_id'];		$edit_action_id = '331';		$delete_action_id = '332';		                                if($search!='')                {                    //$search_str = 'AND exl_name LIKE %"'.$search.'"%';                    $search_str = " AND `exl_name` LIKE '%".$search."%' ";                }                else                {                   $search_str ='';                 }                                 if($status!='')                {                    //$status_str = ' AND status= '.$status.' ';                    $status_str = " AND status= '".$status."' ";                }                else                {                   $status_str ='';                 }                                 if($updated_by!='')                {                    //$updated_by = ' AND user_id= '.$updated_by.' ';                     $updated_by = " AND user_id= '".$updated_by."' ";                }                else                {                   $updated_by ='';                 }                		$edit = $this->chkValidActionPermission($admin_id,$edit_action_id);				$delete = $this->chkValidActionPermission($admin_id,$delete_action_id);			$sql = "SELECT * FROM `tbl_exclusion` where 1 $search_str $status_str $updated_by ORDER BY `exl_name` DESC";							//$this->execute_query($sql);		$STH = $DBH->prepare($sql);                $STH->execute();		$total_records=$STH->rowCount();		$record_per_page=100;		$scroll=5;		$page=new Page();         	$page->set_page_data($_SERVER['PHP_SELF'],$total_records,$record_per_page,$scroll,true,true,true);		$page->set_link_parameter("Class = paging");		$page->set_qry_string($str="mode=exclusion");	 	///$result=$this->execute_query($page->get_limit_query($sql));		$STH2 = $DBH->prepare($page->get_limit_query($sql));                $STH2->execute();		$output = '';				if($STH2->rowCount() > 0)		{			if( isset($_GET['page']) && is_numeric($_GET['page']) && $_GET['page'] > 0 )			{				$i = $page->start + 1;			}			else			{				$i = 1;			}						while($row = $STH2->fetch(PDO::FETCH_ASSOC))			{			    if($row['status'] == 1)					{						 $status = 'Active'; 					}					else					{ 						$status = 'Inactive';					}                                                                                 $start_date = ($row['start_date']!='0000-00-00'? $row['start_date'] : '');                                        $end_date = ($row['end_date']!='0000-00-00'? $row['end_date'] : '');                                        $single_date = ($row['single_date']!='0000-00-00'? $row['single_date'] : '');                                        				$output .= '<tr class="manage-row">';				$output .= '<td height="30"  align="center" nowrap="nowrap" >'.$i.'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['exl_name']).'</td>';                                if($row['page_type'] == 'Page')                                {                                    $output .= '<td height="30" align="center">'.stripslashes($this->getPagenamebyid($row['page_id'])).'</td>';                                }                                else                                {                                    $output .= '<td height="30" align="center">'.stripslashes($this->getAdminMenuName($row['page_id'])).'</td>';                                }                                				$output .= '<td height="30" align="center">'.stripslashes($row['user_type']).'</td>';				$output .= '<td height="30" align="center">'.$obj->getAdminNameRam($row['user_id']).'</td>';				$output .= '<td height="30" align="center">'.stripslashes($row['add_date']).'</td>';                                $output .= '<td height="30" align="center">'.$status.'</td>';				$output .= '<td height="30" align="center" nowrap="nowrap">';						if($edit) {				$output .= '<a href="index.php?mode=edit_exclusion&id='.$row['exl_id'].'" ><img src = "images/edit.gif" border="0"></a>';								}				$output .= '</td>';				$output .= '<td height="30" align="center" nowrap="nowrap">';						if($delete) {				$output .= '<a href=\'javascript:fn_confirmdelete("Theam","sql/delexclusion.php?id='.$row['exl_id'].'")\' ><img src = "images/del.gif" border="0" ></a>';							}				$output .= '</td>';				$output .= '</tr>';				$i++;			}		}		else		{			$output = '<tr class="manage-row" height="20"><td colspan="9" align="center">NO PAGES FOUND</td></tr>';		}				$page->get_page_nav();		return $output;	}	 public function getPagenamebyid($page_id) {                      $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();            $DBH->beginTransaction();            $page_name = '';		            $sql = "SELECT * FROM `tblpages` WHERE `page_id` ='".$page_id."' ";            //echo $sql;            $STH = $DBH->prepare($sql);            $STH->execute();            if($STH->rowCount() > 0)            {                $row = $STH->fetch(PDO::FETCH_ASSOC);                $page_name = $row['page_name'];                            }            return $page_name;                     }            public function getAdminMenuName($menu_id)        {            $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();            $DBH->beginTransaction();            $menu_name = '';            $sql = "SELECT * FROM `tbladminmenu` WHERE `status` = '1'  AND `menu_id` = '".$menu_id."' ";                $STH = $DBH->prepare($sql);            $STH->execute();            if($STH->rowCount() > 0)            {                while($row = $STH->fetch(PDO::FETCH_ASSOC))                 {                    $menu_name = stripslashes($row['menu_name']);                                  }                       }            return $menu_name;        }            public function getPageNameVivek()	{           $my_DBH = new mysqlConnection();          $DBH = $my_DBH->raw_handle();          $DBH->beginTransaction();            $fav_cat_type = array();            //$sql = "SELECT * FROM `tblfavcategorytype` WHERE `fav_cat_type_id` = '".$fav_cat_type_id."' ";            $sql = "SELECT * FROM `tbladminmenu` WHERE 1 ORDER BY `menu_name`";           // $this->execute_query($sql);            $STH = $DBH->prepare($sql);           $STH->execute();           if($STH->rowCount() > 0)            {                while($row = $STH->fetch(PDO::FETCH_ASSOC))                {                $fav_cat_type[] = $row;                }            }            return $fav_cat_type;	}        public function Add_Exclusion($exl_name,$page_type,$selected_page_id,$user_id)	{		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();		$return=false;                                for($i=0;$i<count($selected_page_id);$i++)                {                		$ins_sql = "INSERT INTO `tbl_exclusion`(`exl_name`,`page_id`,`page_type`,`user_id`,`user_type`,`status`) VALUES ('".addslashes($exl_name)."','".addslashes($selected_page_id[$i])."','".addslashes($page_type)."','".addslashes($user_id)."','1','1')";				$STH = $DBH->prepare($ins_sql);                $STH->execute();                                }                		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;	}        public function Update_Exclusion($exl_id,$status,$exl_name,$page_name,$user_id)	{ 		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();                $DBH->beginTransaction();		$return=false;                $sql = "UPDATE `tbl_exclusion` SET `exl_name` = '".addslashes($exl_name)."' ,`status` = '".$status."' ,`user_id` = '".addslashes($user_id)."',`user_type` = '1'  WHERE `exl_id` = '".$exl_id."'";	                 $STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;	}		public function getExclusionDetails($exl_id)	{		//$this->connectDB();		$my_DBH = new mysqlConnection();                $DBH = $my_DBH->raw_handle();               $DBH->beginTransaction();		$page_name = '';		$status = '';		$exl_name = '';	   						$sql = "SELECT * FROM `tbl_exclusion` WHERE `exl_id` = '".$exl_id."'";						//$this->execute_query($sql);		$STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$row = $STH->fetch(PDO::FETCH_ASSOC);			$exl_name = stripslashes($row['exl_name']);			$page_name = stripslashes($row['page_name']);                        $page_id = stripslashes($row['page_id']);                        $page_type = stripslashes($row['page_type']);                        $status = stripslashes($row['status']);					}		return array($exl_name,$page_name,$page_id,$page_type,$status);	}                public function DeleteExclusion($id)	{            $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();            $DBH->beginTransaction();	   $return=false;		$sql = "DELETE  FROM `tbl_exclusion` WHERE `exl_id` = '".$id."'";		$STH = $DBH->prepare($sql);                $STH->execute();		if($STH->rowCount() > 0)		{			$return = true;		}		return $return;	}   public function getAdminDropdown($updated_by)    {        $my_DBH = new mysqlConnection();        $DBH = $my_DBH->raw_handle();        $DBH->beginTransaction();        $option_str = '';		        $sql = "SELECT * FROM `tbladmin` WHERE `status` = '1' ORDER BY `username` ASC";        $STH = $DBH->prepare($sql);        $STH->execute();        if($STH->rowCount() > 0)        {            while($row = $STH->fetch(PDO::FETCH_ASSOC))             {                if($row['admin_id'] == $updated_by)                {                    $sel = ' selected ';                }                else                {                    $sel = '';                }                                               $option_str .= '<option value="'.$row['admin_id'].'" '.$sel.'>'.stripslashes($row['fname']).' '.stripslashes($row['lname']).'</option>';            }        }        return $option_str;    }     //        class exclusion end//        vivek end public function getAllPagesData($page_name,$page_id)        {            //$this->connectDB();            $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();            $DBH->beginTransaction();            $option_str = '';            $sql = "SELECT * FROM `tblpagedropdowns` WHERE `pd_id` = '".$page_name."' ";                //$this->execute_query($sql);            $STH = $DBH->prepare($sql);            $STH->execute();            if($STH->rowCount()  > 0)            {                               $i = 1;                                $row = $STH->fetch(PDO::FETCH_ASSOC);                                $data1 = explode(',', $row['page_id_str']);                $data2 = explode(',', $row['menu_id']);                                $data = array_merge($data1,$data2);                                for($i=0;$i<count($data);$i++)                {                    if($page_id == $data[$i])                    {                       $sel ='selected';                     }                    else                    {                       $sel='';                     }                    if($row['page_type'] == 'Page')                    {                      $page_name = $this->getPagenamebyid($data[$i]);                       }                    else                    {                        $page_name = $this->getAdminMenuName($data[$i]);                         }                                        $option_str .= '<option value="'.$data[$i].'" '.$sel.'>'.$page_name.'</option>';                }                                                                           }            return $option_str;        }              public function getdylgroupcodeoption($fav_cat_type_id,$fav_cat_id)	{           $my_DBH = new mysqlConnection();           $DBH = $my_DBH->raw_handle();           $DBH->beginTransaction();           $option_str = '';		                        $fav_cat_type_id = explode(',', $fav_cat_type_id);            $fav_cat_type_id = implode('\',\'', $fav_cat_type_id);                        $sql = "SELECT * FROM `tblcustomfavcategory` "                    . "LEFT JOIN tblfavcategory ON tblcustomfavcategory.favcat_id = tblfavcategory.fav_cat_id WHERE tblcustomfavcategory.fav_cat_type_id IN('".$fav_cat_type_id."') and tblfavcategory.fav_cat_status = 1 and tblfavcategory.fav_cat_deleted = 0 and tblcustomfavcategory.cat_deleted=0 and tblcustomfavcategory.cat_status = 1 ORDER BY tblfavcategory.fav_cat ASC";            //echo $sql;            $STH = $DBH->query($sql);            if( $STH->rowCount() > 0 )            {                while($row = $STH->fetch(PDO::FETCH_ASSOC))                {                    if($row['favcat_id'] == $fav_cat_id)                    {                            $sel = ' selected ';                    }                    else                    {                            $sel = '';                    }	                    $cat_name = $row['fav_cat'];                    $option_str .= '<option value="'.$row['favcat_id'].'" '.$sel.'>'.stripslashes($cat_name).'</option>';                }            }            //echo $option_str;                        return $option_str;	}                 public function getdylgroupcodeoptionEdit($group_code)	{           $my_DBH = new mysqlConnection();           $DBH = $my_DBH->raw_handle();           $DBH->beginTransaction();           $option_str = '';		                        $sql = "SELECT DISTINCT group_code_id FROM `tbl_design_your_life` WHERE `status` = 1 AND `is_deleted` = 0 and group_code_id!='' ";            $STH = $DBH->query($sql);            if( $STH->rowCount() > 0 )            {                while($row = $STH->fetch(PDO::FETCH_ASSOC))                {                    if($row['group_code_id'] == $group_code)                    {                            $sel = ' selected ';                    }                    else                    {                            $sel = '';                    }	                    $option_str .= '<option value="'.$row['group_code_id'].'" '.$sel.'>'.$this->getFavCategoryNameRamakant($row['group_code_id']).'</option>';                }            }            //echo $option_str;                        return $option_str;	}     public function getFavCategoryNameRamakant($fav_cat_id)	{            $my_DBH = new mysqlConnection();            $DBH = $my_DBH->raw_handle();            $DBH->beginTransaction();            $fav_cat_type = '';            //$sql = "SELECT * FROM `tblfavcategorytype` WHERE `fav_cat_type_id` = '".$fav_cat_type_id."' ";            $sql = "SELECT * FROM `tblfavcategory` WHERE `fav_cat_id` = '".$fav_cat_id."' ";            $STH = $DBH->prepare($sql);            $STH->execute();            if($STH->rowCount() > 0)            {                $row = $STH->fetch(PDO::FETCH_ASSOC);                $fav_cat_type = stripslashes($row['fav_cat']);            }            return $fav_cat_type;	}           }?>